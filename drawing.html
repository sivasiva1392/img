<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- SEO Meta Tags -->
  <title>Free Online Drawing Tool - PixifyNow | Digital Canvas & Sketch Pad</title>
  <meta name="description" content="Free online drawing tool with brushes, colors, shapes, and layers. Create digital art, sketches, and drawings online. No download required." />
  <meta name="keywords" content="online drawing tool, digital canvas, sketch pad, drawing app, free drawing, paint online, digital art, online paint, drawing software, canvas drawing, digital sketchbook" />
  <meta name="author" content="PixifyNow Team" />
  <meta name="robots" content="index, follow" />
  <meta name="language" content="English" />
  <meta name="revisit-after" content="7 days" />
  <meta name="distribution" content="global" />
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Free Online Drawing Tool - PixifyNow" />
  <meta property="og:description" content="Create digital art and drawings online with professional drawing tools. Free, no registration required." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://pixifynow.com/drawing.html" />
  <meta property="og:site_name" content="PixifyNow" />
  <meta property="og:image" content="https://pixifynow.com/logo.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:locale" content="en_US" />
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Free Online Drawing Tool - PixifyNow" />
  <meta name="twitter:description" content="Create digital art and drawings online with professional drawing tools. Completely free." />
  <meta name="twitter:image" content="https://pixifynow.com/logo.png" />
  <meta name="twitter:site" content="@pixifynow" />
  <meta name="twitter:creator" content="@pixifynow" />
  
  <!-- Additional SEO Meta Tags -->
  <meta name="theme-color" content="#007bff" />
  <meta name="msapplication-TileColor" content="#007bff" />
  <meta name="application-name" content="PixifyNow" />
  <meta name="apple-mobile-web-app-title" content="PixifyNow" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="format-detection" content="telephone=no" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://pixifynow.com/drawing.html" />
  
  <!-- Structured Data - WebApplication -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "PixifyNow Drawing Tool",
    "url": "https://pixifynow.com/drawing.html",
    "description": "Free online drawing tool with professional drawing tools, brushes, shapes, and colors",
    "applicationCategory": "GraphicsApplication",
    "operatingSystem": "Any",
    "browserRequirements": "HTML5, CSS3, JavaScript",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Drawing Tools",
      "Brushes",
      "Shapes",
      "Colors",
      "Fill Tool",
      "Text Tool",
      "Undo/Redo",
      "Canvas Drawing"
    ],
    "screenshot": "https://pixifynow.com/drawing-screenshot.png"
  }
  </script>
  
  <!-- Structured Data - BreadcrumbList -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://pixifynow.com/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Drawing",
        "item": "https://pixifynow.com/drawing.html"
      }
    ]
  }
  </script>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom shadow-sm">
    <div class="container">
      <a class="navbar-brand fw-bold text-primary" href="index.html">
        <img src="logo.png" alt="Pixify Now" style="width: auto; height: 30px;"> PixifyNow
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
        <div class="navbar-nav">
          <a class="nav-link border border-primary text-primary rounded px-3 py-2 mx-1 hover-bg-primary" href="index.html">
            ğŸ¨ <strong>Editor</strong>
          </a>
          <a class="nav-link active bg-primary text-white rounded px-3 py-2 mx-1" href="drawing.html">
            âœï¸ <strong>Drawing</strong>
          </a>
          <a class="nav-link border border-primary text-primary rounded px-3 py-2 mx-1 hover-bg-primary" href="meme.html">
            ğŸ˜‚ <strong>Meme</strong>
          </a>
          <a class="nav-link border border-primary text-primary rounded px-3 py-2 mx-1 hover-bg-primary" href="about.html">
            â„¹ï¸ <strong>About</strong>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <style>
    .nav-link.hover-bg-primary:hover {
      background-color: #007bff !important;
      color: white !important;
      transition: all 0.3s ease;
    }
    .navbar-brand {
      transition: transform 0.2s ease;
    }
    .navbar-brand:hover {
      transform: scale(1.05);
    }
    .nav-link {
      transition: all 0.3s ease;
      font-weight: 500;
    }
    .nav-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,123,255,0.2);
    }
    
    /* Reduce main content font sizes - even smaller */
    main {
      font-size: 0.75rem !important;
    }
    
    main h1 {
      font-size: 1.2rem !important;
    }
    
    main h2 {
      font-size: 1rem !important;
    }
    
    main h3 {
      font-size: 0.9rem !important;
    }
    
    main h4 {
      font-size: 0.85rem !important;
    }
    
    main h5 {
      font-size: 0.8rem !important;
    }
    
    main h6 {
      font-size: 0.75rem !important;
    }
    
    main p {
      font-size: 0.75rem !important;
    }
    
    main .form-label {
      font-size: 0.7rem !important;
    }
    
    main .btn {
      font-size: 0.75rem !important;
    }
    
    main .form-control {
      font-size: 0.75rem !important;
    }
    
    main .form-select {
      font-size: 0.75rem !important;
    }
    
    main .card {
      font-size: 0.75rem !important;
    }
    
    main .card-title {
      font-size: 0.8rem !important;
    }
    
    main .card-text {
      font-size: 0.75rem !important;
    }
    
    /* Reduce working area sizes - even smaller */
    .drawing-canvas {
      border: 1.5px solid #dee2e6;
      border-radius: 4px;
      cursor: crosshair;
      display: block;
      margin: 0 auto;
      background: white;
      box-shadow: 0 1px 4px rgba(0,0,0,0.06);
      max-width: 100%;
      height: auto;
    }
    
    .tool-btn {
      width: 32px;
      height: 32px;
      border: 1px solid #dee2e6;
      background: white;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.7rem;
    }
    
    .color-palette {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 3px;
    }
    
    .color-option {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      cursor: pointer;
      border: 1px solid transparent;
      transition: all 0.2s ease;
    }
    
    .brush-size-preview {
      width: 100%;
      height: 28px;
      border: 1px solid #dee2e6;
      border-radius: 2px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
    }
    
    main .card-body {
      padding: 0.6rem !important;
    }
    
    main .card {
      margin-bottom: 0.6rem !important;
    }
    
    .form-range {
      height: 1rem;
    }
    
    .btn-sm {
      padding: 0.2rem 0.4rem;
      font-size: 0.65rem;
    }
    
    .input-group .form-control {
      padding: 0.3rem 0.6rem;
      font-size: 0.7rem;
    }
    
    .form-control-color {
      width: 2rem;
      height: 2rem;
    }
    
    .drawing-canvas {
      border: 2px solid #dee2e6;
      border-radius: 8px;
      cursor: crosshair;
      display: block;
      margin: 0 auto;
      background: white;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .tool-btn {
      width: 50px;
      height: 50px;
      border: 2px solid #dee2e6;
      background: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .tool-btn:hover {
      background: #f8f9fa;
      transform: translateY(-2px);
    }
    
    .tool-btn.active {
      background: #007bff;
      color: white;
      border-color: #007bff;
    }
    
    .color-palette {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 5px;
    }
    
    .color-option {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.2s ease;
    }
    
    .color-option:hover {
      transform: scale(1.1);
    }
    
    .color-option.active {
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0,123,255,0.2);
    }
    
    .brush-size-preview {
      width: 100%;
      height: 40px;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
    }
    
    .brush-preview-dot {
      background: #333;
      border-radius: 50%;
      transition: all 0.2s ease;
    }
  </style>

  <!-- Main Content -->
  <main class="container py-4">
    <!-- Header -->
    <div class="text-center mb-4">
      <h1 class="display-5 fw-bold mb-2">âœï¸ Digital Drawing Canvas</h1>
      <p class="lead text-muted">Create digital art, sketches, and drawings with professional tools</p>
    </div>

    <!-- Drawing Tools Panel -->
    <div class="row mb-3">
      <div class="col-lg-12">
        <div class="card shadow-sm">
          <div class="card-body p-3">
            <div class="row g-3">
              <!-- Drawing Tools -->
              <div class="col-md-3">
                <h6 class="mb-2">ğŸ› ï¸ Tools</h6>
                <div class="d-flex gap-2 flex-wrap">
                  <button class="tool-btn active" data-tool="pen" title="Pen">
                    âœï¸
                  </button>
                  <button class="tool-btn" data-tool="brush" title="Brush">
                    ğŸ–Œï¸
                  </button>
                  <button class="tool-btn" data-tool="eraser" title="Eraser">
                    ğŸ§¹
                  </button>
                  <button class="tool-btn" data-tool="line" title="Line">
                    ğŸ“
                  </button>
                  <button class="tool-btn" data-tool="rectangle" title="Rectangle">
                    â¬œ
                  </button>
                  <button class="tool-btn" data-tool="circle" title="Circle">
                    â­•
                  </button>
                  <button class="tool-btn" data-tool="text" title="Text">
                    ğŸ“
                  </button>
                  <button class="tool-btn" data-tool="fill" title="Fill">
                    ğŸª£
                  </button>
                </div>
              </div>

              <!-- Brush Size -->
              <div class="col-md-2">
                <h6 class="mb-2">ğŸ“ Brush Size</h6>
                <input type="range" class="form-range" id="brushSize" min="1" max="50" value="5">
                <div class="brush-size-preview mt-2">
                  <div class="brush-preview-dot" id="brushPreview"></div>
                </div>
                <small class="text-muted">Size: <span id="sizeValue">5</span>px</small>
              </div>

              <!-- Color Selection -->
              <div class="col-md-4">
                <h6 class="mb-2">ğŸ¨ Colors</h6>
                <div class="color-palette mb-2">
                  <div class="color-option active" style="background: #000000" data-color="#000000"></div>
                  <div class="color-option" style="background: #FF0000" data-color="#FF0000"></div>
                  <div class="color-option" style="background: #00FF00" data-color="#00FF00"></div>
                  <div class="color-option" style="background: #0000FF" data-color="#0000FF"></div>
                  <div class="color-option" style="background: #FFFF00" data-color="#FFFF00"></div>
                  <div class="color-option" style="background: #FF00FF" data-color="#FF00FF"></div>
                  <div class="color-option" style="background: #00FFFF" data-color="#00FFFF"></div>
                  <div class="color-option" style="background: #FFFFFF; border: 1px solid #ccc" data-color="#FFFFFF"></div>
                  <div class="color-option" style="background: #808080" data-color="#808080"></div>
                  <div class="color-option" style="background: #FFA500" data-color="#FFA500"></div>
                  <div class="color-option" style="background: #800080" data-color="#800080"></div>
                  <div class="color-option" style="background: #FFC0CB" data-color="#FFC0CB"></div>
                  <div class="color-option" style="background: #A52A2A" data-color="#A52A2A"></div>
                  <div class="color-option" style="background: #008000" data-color="#008000"></div>
                  <div class="color-option" style="background: #000080" data-color="#000080"></div>
                  <div class="color-option" style="background: #808000" data-color="#808000"></div>
                </div>
                <div class="input-group">
                  <input type="color" class="form-control form-control-color" id="customColor" value="#000000">
                  <input type="text" class="form-control" id="colorHex" value="#000000" placeholder="#000000">
                </div>
              </div>

              <!-- Actions -->
              <div class="col-md-3">
                <h6 class="mb-2">âš¡ Actions</h6>
                <div class="d-flex gap-2 flex-wrap">
                  <button class="btn btn-outline-primary btn-sm" id="undoBtn">â†¶ Undo</button>
                  <button class="btn btn-outline-primary btn-sm" id="redoBtn">â†· Redo</button>
                  <button class="btn btn-outline-danger btn-sm" id="clearBtn">ğŸ—‘ï¸ Clear</button>
                  <button class="btn btn-success btn-sm" id="downloadBtn">ğŸ’¾ Download</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Canvas Area -->
    <div class="row">
      <div class="col-lg-12">
        <div class="card shadow-sm">
          <div class="card-body p-3">
            <canvas id="drawingCanvas" class="drawing-canvas" width="1200" height="600"></canvas>
          </div>
        </div>
      </div>
    </div>

    <!-- Instructions -->
    <div class="row mt-4">
      <div class="col-lg-12">
        <div class="card shadow-sm">
          <div class="card-body p-4">
            <h5 class="card-title">ğŸ“– How to Use</h5>
            <div class="row">
              <div class="col-md-6">
                <h6>ğŸ› ï¸ Drawing Tools:</h6>
                <ul class="list-unstyled">
                  <li>âœï¸ <strong>Pen:</strong> Draw precise lines</li>
                  <li>ğŸ–Œï¸ <strong>Brush:</strong> Soft brush strokes</li>
                  <li>ğŸ§¹ <strong>Eraser:</strong> Remove drawings</li>
                  <li>ğŸ“ <strong>Line:</strong> Draw straight lines</li>
                  <li>â¬œ <strong>Rectangle:</strong> Draw rectangles</li>
                  <li>â­• <strong>Circle:</strong> Draw circles</li>
                  <li>ğŸ“ <strong>Text:</strong> Add text (click canvas)</li>
                  <li>ğŸª£ <strong>Fill:</strong> Fill areas with color</li>
                </ul>
              </div>
              <div class="col-md-6">
                <h6>ğŸ’¡ Tips:</h6>
                <ul class="list-unstyled">
                  <li>ğŸ–±ï¸ <strong>Click and drag</strong> to draw</li>
                  <li>ğŸ¨ <strong>Choose colors</strong> from palette or custom</li>
                  <li>ğŸ“ <strong>Adjust brush size</strong> with slider</li>
                  <li>â†¶ <strong>Undo/Redo</strong> your actions</li>
                  <li>ğŸ’¾ <strong>Download</strong> your artwork as PNG</li>
                  <li>ğŸ—‘ï¸ <strong>Clear canvas</strong> to start over</li>
                  <li>âŒ¨ï¸ <strong>Keyboard shortcuts:</strong> Ctrl+Z (undo), Ctrl+Y (redo)</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="app__footer mt-5 py-4 border-top">
    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h5>ğŸ¨ Creative Tools</h5>
          <p class="text-muted">Professional drawing and image editing tools. Create digital art, edit photos, and express your creativity.</p>
          <ul class="list-unstyled">
            <li><a href="index.html#filters" class="text-decoration-none">ğŸ¨ Image Filters</a></li>
            <li><a href="drawing.html" class="text-decoration-none">âœï¸ Drawing Canvas</a></li>
            <li><a href="index.html#color" class="text-decoration-none">ğŸ¨ Color Adjustment</a></li>
            <li><a href="index.html#background" class="text-decoration-none">ğŸ–¼ï¸ Background Removal</a></li>
          </ul>
        </div>
        <div class="col-md-4">
          <h5>ğŸ“š Drawing Features</h5>
          <ul class="list-unstyled">
            <li><a href="#" class="text-decoration-none">âœï¸ Multiple Drawing Tools</a></li>
            <li><a href="#" class="text-decoration-none">ğŸ¨ Color Palette</a></li>
            <li><a href="#" class="text-decoration-none">ğŸ“ Adjustable Brush Sizes</a></li>
            <li><a href="#" class="text-decoration-none">â†¶ Undo/Redo Function</a></li>
            <li><a href="#" class="text-decoration-none">ğŸ’¾ Download Artwork</a></li>
            <li><a href="#" class="text-decoration-none">ğŸ“ Text Tool</a></li>
            <li><a href="#" class="text-decoration-none">â¬œ Shape Tools</a></li>
            <li><a href="#" class="text-decoration-none">ğŸª£ Fill Tool</a></li>
          </ul>
        </div>
        <div class="col-md-4">
          <h5>ğŸŒŸ About This Tool</h5>
          <p class="text-muted">Free online drawing canvas with professional tools. Create digital art, sketches, and drawings without downloading software. Perfect for artists, designers, and creative projects.</p>
          <div class="mt-2">
            <small class="text-muted">ğŸš€ Smooth Drawing | ğŸ’ No Watermarks | ğŸ“± Mobile Friendly | ğŸ’¾ PNG Export</small>
          </div>
        </div>
      </div>
      <div class="text-center mt-4 pt-3 border-top">
        <p class="text-muted mb-0">Â© 2026 PixifyNow - Free Online Photo Editor. All rights reserved.</p>
        <p class="text-muted small">Create digital art online â€¢ Professional drawing tools â€¢ No download required â€¢ <a href="about.html" class="text-decoration-none">â„¹ï¸ About</a></p>
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Drawing App Script -->
  <script>
    class DrawingApp {
      constructor() {
        this.canvas = document.getElementById('drawingCanvas');
        this.ctx = this.canvas.getContext('2d');
        this.isDrawing = false;
        this.currentTool = 'pen';
        this.currentColor = '#000000';
        this.brushSize = 5;
        this.history = [];
        this.historyStep = -1;
        this.startX = 0;
        this.startY = 0;
        
        this.setupCanvas();
        this.setupEventListeners();
        this.saveState();
      }
      
      setupCanvas() {
        // Set canvas background
        this.ctx.fillStyle = 'white';
        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
        
        // Set initial drawing settings
        this.ctx.lineCap = 'round';
        this.ctx.lineJoin = 'round';
      }
      
      setupEventListeners() {
        // Canvas events
        this.canvas.addEventListener('mousedown', this.startDrawing.bind(this));
        this.canvas.addEventListener('mousemove', this.draw.bind(this));
        this.canvas.addEventListener('mouseup', this.stopDrawing.bind(this));
        this.canvas.addEventListener('mouseout', this.stopDrawing.bind(this));
        
        // Touch events for mobile
        this.canvas.addEventListener('touchstart', this.handleTouch.bind(this));
        this.canvas.addEventListener('touchmove', this.handleTouch.bind(this));
        this.canvas.addEventListener('touchend', this.stopDrawing.bind(this));
        
        // Tool selection
        document.querySelectorAll('.tool-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            this.currentTool = btn.dataset.tool;
            this.updateCursor();
          });
        });
        
        // Color selection
        document.querySelectorAll('.color-option').forEach(option => {
          option.addEventListener('click', () => {
            document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
            option.classList.add('active');
            this.currentColor = option.dataset.color;
            document.getElementById('customColor').value = this.currentColor;
            document.getElementById('colorHex').value = this.currentColor;
          });
        });
        
        // Custom color
        document.getElementById('customColor').addEventListener('change', (e) => {
          this.currentColor = e.target.value;
          document.getElementById('colorHex').value = e.target.value;
          document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
        });
        
        document.getElementById('colorHex').addEventListener('change', (e) => {
          const color = e.target.value;
          if (/^#[0-9A-F]{6}$/i.test(color)) {
            this.currentColor = color;
            document.getElementById('customColor').value = color;
            document.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
          }
        });
        
        // Brush size
        document.getElementById('brushSize').addEventListener('input', (e) => {
          this.brushSize = e.target.value;
          document.getElementById('sizeValue').textContent = this.brushSize;
          this.updateBrushPreview();
        });
        
        // Action buttons
        document.getElementById('undoBtn').addEventListener('click', () => this.undo());
        document.getElementById('redoBtn').addEventListener('click', () => this.redo());
        document.getElementById('clearBtn').addEventListener('click', () => this.clearCanvas());
        document.getElementById('downloadBtn').addEventListener('click', () => this.download());
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
          if (e.ctrlKey && e.key === 'z') {
            e.preventDefault();
            this.undo();
          } else if (e.ctrlKey && e.key === 'y') {
            e.preventDefault();
            this.redo();
          }
        });
        
        // Initialize brush preview
        this.updateBrushPreview();
      }
      
      handleTouch(e) {
        e.preventDefault();
        const touch = e.touches[0];
        const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 'mousemove', {
          clientX: touch.clientX,
          clientY: touch.clientY
        });
        this.canvas.dispatchEvent(mouseEvent);
      }
      
      startDrawing(e) {
        this.isDrawing = true;
        const rect = this.canvas.getBoundingClientRect();
        const scaleX = this.canvas.width / rect.width;
        const scaleY = this.canvas.height / rect.height;
        this.startX = (e.clientX - rect.left) * scaleX;
        this.startY = (e.clientY - rect.top) * scaleY;
        
        if (this.currentTool === 'text') {
          this.addText(this.startX, this.startY);
          this.isDrawing = false;
        } else if (this.currentTool === 'fill') {
          this.fillArea(Math.floor(this.startX), Math.floor(this.startY));
          this.isDrawing = false;
          this.saveState();
        }
      }
      
      draw(e) {
        if (!this.isDrawing) return;
        
        const rect = this.canvas.getBoundingClientRect();
        const scaleX = this.canvas.width / rect.width;
        const scaleY = this.canvas.height / rect.height;
        const x = (e.clientX - rect.left) * scaleX;
        const y = (e.clientY - rect.top) * scaleY;
        
        this.ctx.lineWidth = this.brushSize;
        
        switch (this.currentTool) {
          case 'pen':
          case 'brush':
            this.ctx.globalCompositeOperation = 'source-over';
            this.ctx.strokeStyle = this.currentColor;
            this.ctx.beginPath();
            this.ctx.moveTo(this.startX, this.startY);
            this.ctx.lineTo(x, y);
            this.ctx.stroke();
            this.startX = x;
            this.startY = y;
            break;
            
          case 'eraser':
            this.ctx.globalCompositeOperation = 'destination-out';
            this.ctx.beginPath();
            this.ctx.moveTo(this.startX, this.startY);
            this.ctx.lineTo(x, y);
            this.ctx.stroke();
            this.startX = x;
            this.startY = y;
            break;
        }
      }
      
      stopDrawing(e) {
        if (!this.isDrawing) return;
        
        if (this.currentTool === 'line' || this.currentTool === 'rectangle' || this.currentTool === 'circle') {
          const rect = this.canvas.getBoundingClientRect();
          const scaleX = this.canvas.width / rect.width;
          const scaleY = this.canvas.height / rect.height;
          const endX = (e.clientX - rect.left) * scaleX;
          const endY = (e.clientY - rect.top) * scaleY;
          
          this.ctx.globalCompositeOperation = 'source-over';
          this.ctx.strokeStyle = this.currentColor;
          this.ctx.lineWidth = this.brushSize;
          
          switch (this.currentTool) {
            case 'line':
              this.ctx.beginPath();
              this.ctx.moveTo(this.startX, this.startY);
              this.ctx.lineTo(endX, endY);
              this.ctx.stroke();
              break;
              
            case 'rectangle':
              this.ctx.beginPath();
              this.ctx.rect(this.startX, this.startY, endX - this.startX, endY - this.startY);
              this.ctx.stroke();
              break;
              
            case 'circle':
              const radius = Math.sqrt(Math.pow(endX - this.startX, 2) + Math.pow(endY - this.startY, 2));
              this.ctx.beginPath();
              this.ctx.arc(this.startX, this.startY, radius, 0, 2 * Math.PI);
              this.ctx.stroke();
              break;
          }
        }
        
        this.isDrawing = false;
        this.saveState();
      }
      
      addText(x, y) {
        const text = prompt('Enter text:');
        if (text) {
          this.ctx.globalCompositeOperation = 'source-over';
          this.ctx.fillStyle = this.currentColor;
          this.ctx.font = `${this.brushSize * 3}px Arial`;
          this.ctx.fillText(text, x, y);
          this.saveState();
        }
      }
      
      fillArea(x, y) {
        // Simple flood fill implementation
        const imageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);
        const targetColor = this.getPixelColor(imageData, x, y);
        const fillColor = this.hexToRgb(this.currentColor);
        
        if (this.colorsMatch(targetColor, fillColor)) return;
        
        const pixelsToCheck = [x, y];
        while (pixelsToCheck.length > 0) {
          const y = pixelsToCheck.pop();
          const x = pixelsToCheck.pop();
          
          const currentColor = this.getPixelColor(imageData, x, y);
          if (this.colorsMatch(currentColor, targetColor)) {
            this.setPixelColor(imageData, x, y, fillColor);
            
            if (x > 0) pixelsToCheck.push(x - 1, y);
            if (y > 0) pixelsToCheck.push(x, y - 1);
            if (x < this.canvas.width - 1) pixelsToCheck.push(x + 1, y);
            if (y < this.canvas.height - 1) pixelsToCheck.push(x, y + 1);
          }
        }
        
        this.ctx.putImageData(imageData, 0, 0);
      }
      
      getPixelColor(imageData, x, y) {
        const index = (y * imageData.width + x) * 4;
        return {
          r: imageData.data[index],
          g: imageData.data[index + 1],
          b: imageData.data[index + 2],
          a: imageData.data[index + 3]
        };
      }
      
      setPixelColor(imageData, x, y, color) {
        const index = (y * imageData.width + x) * 4;
        imageData.data[index] = color.r;
        imageData.data[index + 1] = color.g;
        imageData.data[index + 2] = color.b;
        imageData.data[index + 3] = 255;
      }
      
      colorsMatch(color1, color2) {
        return color1.r === color2.r && color1.g === color2.g && 
               color1.b === color2.b && color1.a === color2.a;
      }
      
      hexToRgb(hex) {
        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        return result ? {
          r: parseInt(result[1], 16),
          g: parseInt(result[2], 16),
          b: parseInt(result[3], 16)
        } : null;
      }
      
      updateCursor() {
        switch (this.currentTool) {
          case 'pen':
          case 'brush':
            this.canvas.style.cursor = 'crosshair';
            break;
          case 'eraser':
            this.canvas.style.cursor = 'grab';
            break;
          case 'text':
            this.canvas.style.cursor = 'text';
            break;
          case 'fill':
            this.canvas.style.cursor = 'cell';
            break;
          default:
            this.canvas.style.cursor = 'crosshair';
        }
      }
      
      updateBrushPreview() {
        const preview = document.getElementById('brushPreview');
        preview.style.width = this.brushSize + 'px';
        preview.style.height = this.brushSize + 'px';
      }
      
      saveState() {
        this.historyStep++;
        if (this.historyStep < this.history.length) {
          this.history.length = this.historyStep;
        }
        this.history.push(this.canvas.toDataURL());
        
        // Limit history to 50 states
        if (this.history.length > 50) {
          this.history.shift();
          this.historyStep--;
        }
      }
      
      undo() {
        if (this.historyStep > 0) {
          this.historyStep--;
          this.restoreState();
        }
      }
      
      redo() {
        if (this.historyStep < this.history.length - 1) {
          this.historyStep++;
          this.restoreState();
        }
      }
      
      restoreState() {
        const img = new Image();
        img.src = this.history[this.historyStep];
        img.onload = () => {
          this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
          this.ctx.drawImage(img, 0, 0);
        };
      }
      
      clearCanvas() {
        if (confirm('Are you sure you want to clear the canvas?')) {
          this.ctx.fillStyle = 'white';
          this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
          this.saveState();
        }
      }
      
      download() {
        const link = document.createElement('a');
        link.download = 'drawing_' + Date.now() + '.png';
        link.href = this.canvas.toDataURL();
        link.click();
      }
    }
    
    // Initialize the drawing app when page loads
    document.addEventListener('DOMContentLoaded', () => {
      new DrawingApp();
    });
  </script>
</body>

</html>
